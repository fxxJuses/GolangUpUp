# 操作系统

## 进程之间如何通信？



- 匿名管道 pipe （直接叫 管道） --- 单向通信（单工）

​	要求两个进程之间由关系，例如父子进程。亲缘关系之间的进程之间的通信。

​	父进程创建完毕后，创建其子进程才可以，并且子进程要继承这个管道。

![image-20230329214449722](C:\Users\14583\AppData\Roaming\Typora\typora-user-images\image-20230329214449722.png)

① 管道是单向的，因此想要创建一个父进程向子进程写的一个管道时，在父进程中是写端，在子进程中是读端。但由于子进程是父进程的继承，因此父进程需要创建两个fd，一个写端，一个读端。然后再创建子进程时，子进程就会继承这两个fd。管道就会选择从父进程的写端指向子进程的读端。

②Linux中一切皆文件，所以管道本质也是文件，只不过是在缓存中的文件。所以管道是一种面向字节流的通信方式。

③管道是一个单向通信的文件，因此如果有一端发送出现了问题，就会引起阻塞；如果有一端出现了断裂，那整个管道就会破裂。

④数据是写一段，然后才会读一段，读写效率都很低



- 命名管道FIFO

​	有名字，无亲缘关系的限制。

![image-20230329215515737](C:\Users\14583\AppData\Roaming\Typora\typora-user-images\image-20230329215515737.png)

管道是一种文件，只是文件结构，没有大小。使用方式和匿名管道类似。



- 消息队列

相当于管道的升级版本。消息队列是由消息的链表，存放在内核中并由消息队列标识符标识。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。

其优势是对每个消息指定特定的消息类型，接收的时候不需要按照队列次序，而是可以根据自定义条件接收特定类型的消息。

可以把消息看做一个记录，具有特定的格式以及特定的优先级。对消息队列有写权限的进程可以向消息队列中按照一定的规则添加新消息，对消息队列有读权限的进程可以从消息队列中读取消息。

- 共享内存

共享内存允许两个或多个进程共享一个给定的存储区，这一段存储区可以被两个或两个以上的进程映射至自身的地址空间中，一个进程写入共享内存的信息，可以被其他使用这个共享内存的进程，通过一个简单的内存读取错做读出，从而实现了进程间的通信。

采用共享内存进行通信的一个主要好处是效率高，因为进程可以直接读写内存，而不需要任何数据的拷贝，对于像管道和消息队里等通信方式，则需要再内核和用户空间进行四次的数据拷贝，而共享内存则只拷贝两次：一次从输入文件到共享内存区，另一次从共享内存到输出文件。

![在这里插入图片描述](https://img-blog.csdnimg.cn/2019042614103483.png)







- 套接字（socket）

与其他通信机制不同的是，它可⽤于不同机器间的进程通信。



- 信号量

信号量是⼀个计数器，可以⽤来控制多个进程对共享资源的访问。它常作为⼀种锁机制，防⽌某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同⼀进程内不同线程之间的同步⼿段

- 信号